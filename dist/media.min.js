var media=function(){this.setter={query:[],main:[],callback:[],active:{query:[]}},this.appearing={setter:{query:[],main:[],callback:[],keys_group:[],active:{query:[]}},comment:{dom:[],key:[]},entity:{dom:[],key:[]}},this._id=0,this.setId=function(e){void 0===e?++this._id:this._id=e},this.getIdBy16=function(){return(this._id+Math.pow(10,8)).toString(16)}};media.prototype.set=function(i,t,e){if("string"==typeof i){var r=this,a=-1;if(this.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)}),-1<a)console.error('Failed to set "'+i+'" querystring, because it was existing');else{if("function"==typeof t){this.setter.query.push(i);var n=null;return n=e?function(e){e.matches?r.setter.active.query.push(i):-1<r.setter.active.query.indexOf(i)&&r.setter.active.query.splice(r.setter.active.query.indexOf(i),1),t(e,r)}:function(e){e.matches?(r.setter.active.query.push(i),t(e,r)):-1<r.setter.active.query.indexOf(i)&&r.setter.active.query.splice(r.setter.active.query.indexOf(i),1)},this.setter.callback.push(n),this.setter.main.push(window.matchMedia(this.setter.query[this.setter.query.length-1])),this.setter.main[this.setter.main.length-1].addListener(this.setter.callback[this.setter.callback.length-1]),this}console.error("callback isn't a function")}}else console.error("querystring must be type of string")},media.prototype.remove=function(i){var e;Array.isArray(i)&&i.length&&(i=(e=i).shift());var r=this,a=-1;return this.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)}),-1<a?(this.setter.main[a].removeListener(this.setter.callback[a]),this.setter.query.splice(a,1),this.setter.main.splice(a,1),this.setter.callback.splice(a,1)):console.warn('"'+i+"\" doesn't exist"),e&&e.length&&this.remove(e),this},media.prototype.getMedia=function(e,t){return"function"!=typeof t?(console.warn("return string that lack of callback"),window.matchMedia(e)):(t(window.matchMedia(e),this),this)},media.prototype.getStatus=function(e){var t={querystrings:this.setter.query.slice(),active_querystrings:this.setter.active.query.slice()};return"function"!=typeof e?(console.warn("return string that lack of callback"),t):(e(t,this),this)},media.prototype.getAppearingStatus=function(e){var t={querystrings:this.appearing.setter.query.slice(),active_querystrings:this.appearing.setter.active.query.slice(),comments:this.appearing.comment.dom,doms:this.appearing.entity.dom};return"function"!=typeof e?(console.warn("return string that lack of callback"),t):(e(t,this),this)},media.prototype.trigger=function(i){var e,r=this;Array.isArray(i)&&i.length&&(i=(e=i).shift());var a=-1;if(this.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)}),-1<a){var t=new Event("change"),n=this.setter.main[a];t.matches="custom"in n?(t.media="media"in n.custom?n.custom.media:n.media,"matches"in n.custom?n.custom.matches:n.matches):(t.media=n.media,n.matches),t.srcElement=n,t.target=n,this.setter.callback[a](t,this)}return e&&e.length&&this.trigger(e),this},media.prototype.triggerAppearingWithMedia=function(e){var t=Object.assign(media.prototype,this);return t.setter=this.appearing.setter,this.trigger.apply(t,[e]),this},media.prototype.matchStr=function(e,t){for(var i=[],r=[],a=[],n=[],s=0;s<e.length;s++)i.push(e[s]),a.push(e[s]);for(s=0;s<t.length;s++)r.push(t[s]),n.push(e[s]);a.map(function(e){var t=r.indexOf(e);-1<t&&r.splice(t,1)});var p=0===r.length;(r=n).map(function(e){var t=i.indexOf(e);-1<t&&i.splice(t,1)});var c=0===i.length;return p&&c},media.prototype.setAppearing=function(i,e){if("string"==typeof i){var r=this,a=-1;if(this.appearing.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)}),!(-1<a)){var n=[];if(Array.isArray(e)){e.filter(function(e){return e}).map(function(e){r.setId();var t=Object.keys(e.dataset).filter(function(e){return/^c-\w+/.test(e)})[0]||"c-"+r.getIdBy16();e.dataset[t]=[],r.appearing.entity.dom.push(e),r.appearing.entity.key.push(t);var i=document.createComment("");r.appearing.comment.key.push(t),r.appearing.comment.dom.push(i),n.push(t)})}else{r.setId();var t=Object.keys(e.dataset).filter(function(e){return/^c-\w+/.test(e)})[0]||"c-"+r.getIdBy16();e.dataset[t]=[],this.appearing.entity.dom.push(e),this.appearing.entity.key.push(t);var s=document.createComment("");this.appearing.comment.key.push(t),this.appearing.comment.dom.push(s),n.push(t)}return this.appearing.setter.keys_group.push(n),this.appearing.setter.query.push(i),this.appearing.setter.callback.push(function(e){r.appearingEffect.apply(r,[i,e.matches])}),this.appearing.setter.main.push(window.matchMedia(this.appearing.setter.query[this.appearing.setter.query.length-1])),this.appearing.setter.main[this.appearing.setter.main.length-1].addListener(this.appearing.setter.callback[this.appearing.setter.callback.length-1]),this}console.error('Failed to set "'+i+'" querystring, because it was existing')}else console.error("querystring must be type of string")},media.prototype.removeAppearing=function(i,e){var t,r=this;Array.isArray(i)&&i.length&&(i=(t=i).shift());var a=-1;if(this.appearing.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)}),-1<a){switch(e){case"appearing":this.appearing.setter.main[a].custom={matches:!0},this.triggerAppearingWithMedia(i);break;case"remove":this.appearing.setter.main[a].custom={matches:!1},this.triggerAppearingWithMedia(i);break;default:this.triggerAppearingWithMedia(i)}this.appearing.setter.main[a].removeListener(this.appearing.setter.callback[a]),this.appearing.setter.query.splice(a,1),this.appearing.setter.main.splice(a,1),this.appearing.setter.callback.splice(a,1),r.appearing.setter.keys_group[a].map(function(e){var t=r.appearing.entity.key.indexOf(e),i=r.appearing.comment.key.indexOf(e);-1<t&&(r.appearing.entity.key.splice(t,1),r.appearing.entity.dom.splice(t,1)),-1<i&&(r.appearing.comment.key.splice(i,1),r.appearing.comment.dom.splice(i,1))}),this.appearing.setter.keys_group.splice(a,1)}else console.warn('"'+i+"\" doesn't exist");return t&&t.length&&this.removeAppearing(t,e),this},media.prototype.appearingEffect=function(i,e){var t,r=this;Array.isArray(i)&&i.length&&(i=(t=i).shift());var a=-1;this.appearing.setter.query.map(function(e,t){r.matchStr(e,i)&&(a=t)});var n=r.appearing.setter.keys_group[a];return 0===n.length||(e?(r.appearing.setter.active.query.push(i),n.map(function(e){var t=r.appearing.comment.key.indexOf(e),i=r.appearing.entity.key.indexOf(e);-1<i&&-1<t&&r.appearing.comment.dom[t].parentNode&&r.appearing.entity.dom[i]&&(r.appearing.comment.dom[t].parentNode.insertBefore(r.appearing.entity.dom[i],r.appearing.comment.dom[t]),r.appearing.comment.dom[t].remove())})):(-1<r.appearing.setter.active.query.indexOf(i)&&r.appearing.setter.active.query.splice(r.appearing.setter.active.query.indexOf(i),1),this.fundIndexByQuerystring(r.appearing.setter.active.query,r.appearing.setter.query,function(t){n=n.filter(function(e){return-1===r.appearing.setter.keys_group[t].indexOf(e)})}),n.map(function(e){var t=r.appearing.entity.key.indexOf(e),i=r.appearing.comment.key.indexOf(e);-1<t&&-1<i&&r.appearing.entity.dom[t].parentNode&&r.appearing.comment.dom[i]&&(r.appearing.entity.dom[t].parentNode.insertBefore(r.appearing.comment.dom[i],r.appearing.entity.dom[t]),r.appearing.entity.dom[t].remove())})),t&&t.length&&this.appearingEffect(t,e)),this},media.prototype.fundIndexByQuerystring=function(e,t,i){var a=this;e.map(function(i){var r=-1;return t.map(function(e,t){a.matchStr(e,i)&&(r=t)}),r}).filter(function(e){return-1<e}).map(i)},"object"==typeof module&&"exports"in module&&(module.exports=media);